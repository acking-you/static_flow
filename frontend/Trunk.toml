# Trunk configuration for StaticFlow frontend

# Build settings
target = "index.html"
dist = "dist"
# Default public_url for normal builds (local dev)
public_url = "/"
filehash = true
release = true

[serve]
port = 8080
open = false
# For local testing to simulate GitHub Pages deployment:
# trunk serve --features mock
# DO NOT use --public-url flag for local testing! It will break routing.
# The mock feature handles path prefixes via conditional compilation in router.rs

# API proxy to backend server
[[proxy]]
backend = "http://localhost:3000/api"

[[hooks]]
stage = "pre_build"
command = "npx"
command_arguments = ["@tailwindcss/cli", "-i", "input.css", "-o", "static/styles.css", "--minify"]

# Note: post_build hook is NOT used for local dev
# Path handling for GitHub Pages is done in GitHub Actions workflow via optimize-wasm.sh
# which injects <base href="/static_flow/"> into the deployed index.html
