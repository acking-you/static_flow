<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨ - L_B__</title><meta name="referrer" content="no-referrer">
<meta name="description" content="asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨"><meta property="og:title" content="asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨" />
<meta property="og:description" content="asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://acking-you.github.io/posts/asyncpackage_task%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E4%BD%BF%E7%94%A8/" /><meta property="og:image" content="https://acking-you.github.io/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-08-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-08-17T00:00:00+00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://acking-you.github.io/logo.png"/>

<meta name="twitter:title" content="asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨"/>
<meta name="twitter:description" content="asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨"/>
<meta name="application-name" content="FeelIt">
<meta name="apple-mobile-web-app-title" content="FeelIt"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="canonical" href="https://acking-you.github.io/posts/asyncpackage_task%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E4%BD%BF%E7%94%A8/" /><link rel="prev" href="https://acking-you.github.io/posts/c&#43;&#43;%E9%9D%A2%E8%AF%95%E4%B8%80%E6%9D%A1%E8%B7%AF/" /><link rel="next" href="https://acking-you.github.io/posts/%E7%BB%86%E7%B2%92%E5%BA%A6%E9%94%81%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E9%98%9F%E5%88%97%E5%AE%9E%E7%8E%B0/" /><link rel="stylesheet" href="/css/page.min.css"><link rel="stylesheet" href="/css/home.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/acking-you.github.io\/posts\/asyncpackage_task%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E4%BD%BF%E7%94%A8\/"
        },"genre": "posts","keywords": "asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨","wordcount":  2780 ,
        "url": "https:\/\/acking-you.github.io\/posts\/asyncpackage_task%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E4%BD%BF%E7%94%A8\/","datePublished": "2022-08-17T00:00:00+00:00","dateModified": "2022-08-17T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": "ä½œè€…"},"author": {
                "@type": "Person",
                "name": "ä½œè€…"
            },"description": "asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨"
    }
    </script></head><body data-header-desktop="auto" data-header-mobile="auto"><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="L_B__">L_B__</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> æ–‡ç«  </a><a class="menu-item" href="/tags/"> æ ‡ç­¾ </a><a class="menu-item" href="/categories/"> åˆ†ç±» </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..." id="search-input-desktop">
                        <a href="#" class="search-button search-toggle" id="search-toggle-desktop" title="æœç´¢">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" class="search-button search-clear" id="search-clear-desktop" title="æ¸…ç©º">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="L_B__">L_B__</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..." id="search-input-mobile">
                        <a href="#" class="search-button search-toggle" id="search-toggle-mobile" title="æœç´¢">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="#" class="search-button search-clear" id="search-clear-mobile" title="æ¸…ç©º">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="#" class="search-cancel" id="search-cancel-mobile">
                        å–æ¶ˆ
                    </a>
                </div><a class="menu-item" href="/posts/" title="">æ–‡ç« </a><a class="menu-item" href="/tags/" title="">æ ‡ç­¾</a><a class="menu-item" href="/categories/" title="">åˆ†ç±»</a><div class="menu-item"><a href="javascript:void(0);" class="theme-switch" title="åˆ‡æ¢ä¸»é¢˜">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div></div>
    </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">ç›®å½•</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single" data-toc="disable"><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://img-blog.csdnimg.cn/img_convert/c592952aec4e1c875073f2a3d970cde5.png#pic_center"
        data-srcset="https://img-blog.csdnimg.cn/img_convert/c592952aec4e1c875073f2a3d970cde5.png#pic_center, https://img-blog.csdnimg.cn/img_convert/c592952aec4e1c875073f2a3d970cde5.png#pic_center 1.5x, https://img-blog.csdnimg.cn/img_convert/c592952aec4e1c875073f2a3d970cde5.png#pic_center 2x"
        data-sizes="auto"
        alt="https://img-blog.csdnimg.cn/img_convert/c592952aec4e1c875073f2a3d970cde5.png#pic_center"
        title="asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨" /></div><div class="single-card" data-image="true"><h2 class="single-title animated flipInX">asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨</h2><div class="post-meta">
                <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>ä½œè€…</a></span>&nbsp;<span class="post-category">å‡ºç‰ˆäº  <a href="/categories/c++%E5%A4%9A%E7%BA%BF%E7%A8%8B/"><i class="far fa-folder fa-fw"></i>C++å¤šçº¿ç¨‹</a></span></div>
                <div class="post-meta-line"><span><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-08-17">2022-08-17</time></span>&nbsp;<span><i class="fas fa-pencil-alt fa-fw"></i>&nbsp;çº¦ 2780 å­—</span>&nbsp;
                    <span><i class="far fa-clock fa-fw"></i>&nbsp;é¢„è®¡é˜…è¯» 6 åˆ†é’Ÿ</span>&nbsp;</div>
            </div>
            
            <hr><div class="details toc" id="toc-static"  data-kept="">
                    <div class="details-summary toc-title">
                        <span>ç›®å½•</span>
                        <span><i class="details-icon fas fa-angle-right"></i></span>
                    </div>
                    <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#ä½¿ç”¨æ–¹æ³•">ä½¿ç”¨æ–¹æ³•</a></li>
    <li><a href="#stdasync">std::async</a></li>
    <li><a href="#stdpackaged_task">std::packaged_task</a></li>
    <li><a href="#stdpromise">std::promise</a></li>
    <li><a href="#è‡ªé¡¶å‘ä¸‹">è‡ªé¡¶å‘ä¸‹</a>
      <ul>
        <li><a href="#ç”¨packaged_taskå®ç°async">ç”¨packaged_taskå®ç°async</a></li>
        <li><a href="#ä½¿ç”¨promiseå®ç°packaged_task">ä½¿ç”¨promiseå®ç°packaged_task</a></li>
      </ul>
    </li>
    <li><a href="#æ€»ç»“">æ€»ç»“</a></li>
  </ul>
</nav></div>
                </div><div class="content" id="content"><h2 id="ä½¿ç”¨æ–¹æ³•">ä½¿ç”¨æ–¹æ³•</h2>
<p>æƒ³è¦æ›´è¯¦å°½çš„ä»‹ç»å¯ä»¥çœ‹çœ‹è¿™æœ¬ä¹¦ï¼Œè¿™å‡ ä¸ªå‡½æ•°ç‰µæ‰¯åˆ°çš„å†…å®¹æ˜¯å¹¶å‘æ“ä½œçš„åŒæ­¥ï¼Œå¯¹åº”<a href="https://nj.gitbooks.io/c/content/content/chapter4/chapter4-chinese.html" target="_blank" rel="noopener noreffer">ã€ŠC++å¹¶å‘ç¼–ç¨‹å®æˆ˜ã€‹</a>çš„ç¬¬å››ç« ï¼Œè¿™æœ¬ä¹¦å¾ˆéš¾å•ƒï¼Œæœ‰å¾ˆå¤šåœ°æ–¹æˆ‘ä¹Ÿæ˜¯æ–­æ–­ç»­ç»­çœ‹äº†å‡ éæ‰æœ‰ä½“ä¼šã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬æ¥çœ‹çœ‹è®©äººè¿·æƒ‘çš„åœ°æ–¹ï¼š<code>std::aync</code>ã€<code>std::package_task</code>ã€<code>std::promise</code> è¿™å‡ ä¸ªè°ƒç”¨éƒ½èƒ½è·å¾— <code>std::future</code>ï¼Œé‚£åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬æŒ¨ä¸ªæ¥çœ‹çœ‹åŸºæœ¬ä½¿ç”¨æ–¹æ³•ï¼Œå†è¿›è¡Œä¸€ä¸ªå°æ€»ç»“ã€‚</p>
<h2 id="stdasync">std::async</h2>
<p><strong>å‰è¨€</strong></p>
<p><code>async</code> è¿™ä¸ªè¯åœ¨å…¶ä»–è¯­è¨€ä¸­æƒ³å¿…ä¹Ÿä¸é™Œç”Ÿï¼Œæ¯”å¦‚ js é‡Œæœ‰awaitå’Œasyncå…³é”®å­—ç”¨äºæ‰§è¡Œå¼‚æ­¥ä»»åŠ¡ç­‰ç­‰ï¼ŒC++ä¸­çš„è¿™ä¸ªè¯è¡¨ç¤ºä¸€ä¸ªå‡½æ•°ï¼Œå®é™…ä¸Šä¹Ÿæ˜¯ç”¨äºå¼‚æ­¥æ‰§è¡Œã€‚ä½†æ˜¯ä¸jsé‚£ä¸ªå®ç°åŸç†æœ‰å¾ˆå¤§çš„ä¸åŒï¼Œç®€å•çš„è¯´å°±æ˜¯jsé‚£ä¸ªæ›´åŠ çš„ä¸Šå±‚ï¼Œè€ŒC++è¿™ä¸ªååº•å±‚ã€‚å¯¼è‡´çš„åŒºåˆ«å°±æ˜¯jsé‚£ä¸¤ä¸ªå…³é”®å­—é…åˆèµ·æ¥åªä¸ºè¾¾åˆ°å¹¶å‘çš„æ•ˆæœï¼Œè€Œå…¶ä¸­çš„å®ç°ç»†èŠ‚æ˜¯éå¸¸å¤æ‚çš„ï¼Œæ¯”å¦‚jså®é™…ä¸Šå§‹ç»ˆåªç”¨åˆ°äº†ä¸€ä¸ªçº¿ç¨‹æ¥å®ç°äº†å¹¶å‘ï¼Œè¿™ç‚¹ç±»ä¼¼äºåç¨‹ï¼Œå…·ä½“åˆ°å†…éƒ¨jsæ˜¯é€šè¿‡äº‹ä»¶å¾ªç¯é˜Ÿåˆ—æ¥å®ç°çš„ï¼Œæ‰€ä»¥ä½ å§‹ç»ˆæ— æ³•ç¡®åˆ‡çš„ç†è§£åˆ°å®ƒçš„åº•å±‚å·¥ä½œã€‚
è€ŒC++çš„asyncä¸ä¹‹ç›¸æ¯”ï¼Œå°±å¥½åƒä¸€ä¸ªåŸå§‹äººï¼Œéœ€è¦ä½ ä¼ é€’å‚æ•°æ¥ç¡®å®šå®ƒçš„å·¥ä½œæœºåˆ¶ï¼Œä½†å’ŒC++æ ‡å‡†åº“çš„å…¶ä»–apiç›¸æ¯”ï¼Œå®ƒå´æ˜¯éå¸¸é«˜çº§çš„å­˜åœ¨ã€‚</p>
<p><strong>ä½¿ç”¨</strong></p>
<p>åœ¨æ­¤ä¹‹å‰å…ˆç®€å•äº†è§£ä¸‹C++çš„asyncä½¿ç”¨æ–¹å¼ï¼Œä¸€ä¸ªç®€å•çš„ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;future&gt;</span><span class="cp">
</span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp"></span><span class="kt">int</span> <span class="nf">find_the_answer_to_ltuae</span><span class="p">();</span>
<span class="kt">void</span> <span class="nf">do_other_stuff</span><span class="p">();</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">future</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">the_answer</span><span class="o">=</span><span class="n">std</span><span class="o">::</span><span class="n">async</span><span class="p">(</span><span class="n">find_the_answer_to_ltuae</span><span class="p">);</span>
    <span class="n">do_other_stuff</span><span class="p">();</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&#34;The answer is &#34;</span><span class="o">&lt;&lt;</span><span class="n">the_answer</span><span class="p">.</span><span class="n">get</span><span class="p">()</span><span class="o">&lt;&lt;</span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><p>è¿™ä¸ªå‡½æ•°ä¼šè¿”å›ä¸€ä¸ªfutureç”¨äºå°†å¼‚æ­¥çš„ä»»åŠ¡å’Œä¸»çº¿ç¨‹åŒæ­¥ã€‚ä¹Ÿå°±æ˜¯å½“ä½ è°ƒç”¨futureçš„getæ–¹æ³•æ—¶ï¼Œå®ƒä¼šç­‰å¾…å¼‚æ­¥ä»»åŠ¡å®Œæˆï¼Œå¹¶å¾—åˆ°å¯¹åº”çš„è¿”å›å€¼ã€‚
å…³äº <code>std::future</code> ä¹Ÿæœ‰ä¸‰ä¸ªé‡è¦çš„apiï¼šwaitã€wait_forã€getï¼Œå‰é¢ä¸¤ä¸ªä¸è¿”å›ç»“æœï¼Œåªç­‰å¾…ä»»åŠ¡ï¼Œwait_forå¯ä»¥è®¾ç½®ç­‰å¾…çš„æ—¶é—´é™åˆ¶ã€‚</p>
<p>ä½†æ˜¯è¯·æ³¨æ„ï¼Œè¿™ä¸ªä»»åŠ¡ä¸ä¸€å®šæ˜¯æŒ‰ç…§ä½ æƒ³çš„é‚£æ ·å¼‚æ­¥æ‰§è¡Œçš„ï¼Œå®ƒå¯èƒ½åœ¨ä½ è°ƒç”¨getæ–¹æ³•çš„æ—¶å€™æ‰æ‰§è¡Œï¼Œè¿™ä¸ªå–å†³äºä½ ä¼ é€’çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚</p>
<ul>
<li>std::launch::asyncï¼šè¡¨ç¤ºä¼šå¼€å¯ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡ã€‚</li>
<li>std::launch::deferredï¼šè¡¨ç¤ºå»¶è¿Ÿè°ƒç”¨ï¼Œåªæœ‰åœ¨å¤–ç•Œéœ€è¦å¾—åˆ°ç»“æœçš„æ—¶å€™æ‰è°ƒç”¨ã€‚</li>
<li>ä¸ä¼ å‚æ•°æˆ–è€…ä¸¤è€…ç›¸ä¸ï¼šè¡¨ç¤ºç”±C++åº•å±‚å»è°ƒåº¦ï¼Œå¯èƒ½æ˜¯asyncä¹Ÿå¯èƒ½æ˜¯defferredã€‚</li>
</ul>
<p>å®é™…ä¸Šasyncå‡½æ•°åœ¨è¿™å‡ ä¸ªC++çš„apié‡Œæ˜¯æœ€é«˜çº§çš„ï¼Œå®ƒåŒæ—¶æ‹¥æœ‰äº†å¼‚æ­¥ä¸åŒæ­¥çš„èƒ½åŠ›ã€‚</p>
<h2 id="stdpackaged_task">std::packaged_task</h2>
<p>è¿™ä¸ªapiä¸çº¿ç¨‹æ˜¯æ²¡æœ‰ä»»ä½•å…³ç³»çš„ï¼Œå®ƒåªæ˜¯è´Ÿè´£æŠŠæ™®é€šçš„å‡½æ•°æˆ–è€…ä»¿å‡½æ•°åŒ…è£…æˆæ–¹ä¾¿å¼‚æ­¥è½¬åŒæ­¥çš„ä»»åŠ¡ã€‚</p>
<p>æ¯”å¦‚æˆ‘ä»¬å¼€å¯ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡ï¼Œæˆ‘ä»¬åˆæƒ³å¯¹å¤–ç•Œä¿æœ‰åŒæ­¥è·å–ä»»åŠ¡ç»“æœçš„èƒ½åŠ›ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨ <code>std::package_task</code> æ¥å¯¹ç°æœ‰çš„ä»»åŠ¡è¿›è¡Œå°è£…äº†ã€‚
å¦‚ä¸‹ä»£ç ï¼š</p>
<blockquote>
<p>ä»¥æŠ–éŸ³ç”¨æˆ·çš„ä¸€æ¬¡ç‚¹èµè¡Œä¸ºå¯¹åº”çš„æ•°æ®åº“åº•å±‚éœ€è¦è°ƒç”¨çš„apiä¸¾ä¾‹å­ï¼š
plusVideoLike:å¢åŠ å¯¹åº”è§†é¢‘çš„ç‚¹èµæ•°ç›®ï¼Œè¿”å›å€¼ä¸ºè‡ªå®šä¹‰çš„errorç±»å‹
plusUserLikeList:å¢åŠ ç”¨æˆ·å–œæ¬¢çš„è§†é¢‘ï¼Œè¿”å›å€¼ä¸ºè‡ªå®šä¹‰çš„errorç±»å‹
å¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªä¸¤ä¸ªè¿‡ç¨‹äº’ç›¸å¹¶ä¸å½±å“ï¼Œå¯ä»¥ä½¿ç”¨å¹¶å‘æ“ä½œè¿›è¡Œã€‚</p>
</blockquote>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">UserService</span><span class="o">::</span><span class="n">addLike</span><span class="p">(</span><span class="kt">int</span> <span class="n">uid</span><span class="p">,</span><span class="kt">int</span> <span class="n">vid</span><span class="p">){</span>
    <span class="k">auto</span> <span class="n">task1</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">package_task</span><span class="o">&lt;</span><span class="n">error</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="o">&gt;</span><span class="p">{</span><span class="n">plusVideoLike</span><span class="p">};</span>
    <span class="k">auto</span> <span class="n">task2</span> <span class="o">=</span> <span class="n">std</span><span class="o">::</span><span class="n">package_task</span><span class="o">&lt;</span><span class="n">error</span><span class="p">(</span><span class="kt">int</span><span class="p">,</span><span class="kt">int</span><span class="p">)</span><span class="o">&gt;</span><span class="p">{</span><span class="n">plusUserLikeList</span><span class="p">};</span>
    <span class="k">auto</span> <span class="n">f1</span> <span class="o">=</span> <span class="n">task1</span><span class="p">.</span><span class="n">get_future</span><span class="p">();</span>
    <span class="k">auto</span> <span class="n">f2</span> <span class="o">=</span> <span class="n">task2</span><span class="p">.</span><span class="n">get_future</span><span class="p">();</span>
    <span class="n">std</span><span class="o">::</span><span class="kr">thread</span> <span class="n">t1</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span>
       <span class="n">task1</span><span class="p">(</span><span class="n">vid</span><span class="p">);</span> <span class="c1">//videoç‚¹èµ+1 
</span><span class="c1"></span>    <span class="p">});</span>
    <span class="n">std</span><span class="o">::</span><span class="kr">thread</span> <span class="n">t2</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span>
        <span class="n">task2</span><span class="p">(</span><span class="n">uid</span><span class="p">,</span><span class="n">vid</span><span class="p">);</span> <span class="c1">//ç”¨æˆ·ç‚¹èµè§†é¢‘+1
</span><span class="c1"></span>    <span class="p">});</span>
    
    <span class="c1">//å¾—åˆ°è¿”å›å€¼çš„åŒæ—¶å®ŒæˆåŒæ­¥æ“ä½œ
</span><span class="c1"></span>    
    <span class="k">if</span><span class="p">(</span><span class="n">f1</span><span class="p">.</span><span class="n">get</span><span class="p">()</span> <span class="o">==</span> <span class="err">æŸé”™è¯¯</span><span class="p">){</span>
        
    <span class="p">}</span>
    <span class="k">if</span><span class="p">(</span><span class="n">f2</span><span class="p">.</span><span class="n">get</span><span class="p">()</span><span class="o">==</span> <span class="err">æŸé”™è¯¯</span><span class="p">{</span>
    
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h2 id="stdpromise">std::promise</h2>
<p>ä»ä¸Šé¢çœ‹ä¸‹æ¥ï¼Œæˆ‘ä»¬å…¶å®ä¸éš¾å‘ç°ï¼Œasyncå’Œpackaged_taskå¥½åƒæœ‰æŸç§è”ç³»ï¼Ÿä¼¼ä¹asyncæ˜¯å°è£…äº†packaged_taskçš„æ–¹ä¾¿æ“ä½œçš„apiï¼Œæ²¡é”™å¤§æ¦‚å°±æ˜¯è¿™æ ·ã€‚åŒæ ·promiseä¹Ÿæ˜¯packaged_taskä¸­ä¸å¯ç¼ºå°‘çš„ä¸€ç¯ã€‚</p>
<p>std::promiseç®—æ˜¯C++ä¸­æä¾›çš„æ–¹ä¾¿çº¿ç¨‹é—´é€šä¿¡çš„çº½å¸¦ä¹‹ä¸€ï¼Œå®ƒçš„è¡Œä¸ºæœ‰äº›ç±»ä¼¼äºç®¡é“ï¼Œç†Ÿæ‚‰Goçš„æœ‹å‹ï¼Œä½ å¯ä»¥æŠŠè¿™ä¸ªç±»ä¼¼äºæ— ç¼“å†²çš„ç®¡é“ï¼Œé€šè¿‡promiseæˆ‘ä»¬å­˜å…¥æ•°æ®ï¼Œé€šè¿‡å®ƒçš„futureæˆ‘ä»¬è¯»å–æ•°æ®ï¼Œè¿™é‡Œå°±ç±»ä¼¼äºç®¡é“çš„è¯»å†™äº†ï¼Œåªä¸è¿‡ä¸èƒ½é€šè¿‡ä¸€ä¸ªç±»å‹è¿›è¡ŒåŒå‘è¯»å†™ï¼Œè¿™ä¸€ç‚¹è¿˜æ˜¯æ²¡æœ‰Golangçš„æ–¹ä¾¿å•Šã€‚</p>
<p>çº¿ç¨‹é—´é€šä¿¡æˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯é€šè¿‡å…±äº«å†…å­˜ï¼Œè€Œå…±äº«å†…å­˜å†™èµ·æ¥å°±å¾ˆéº»çƒ¦ï¼Œä¸ºäº†çº¿ç¨‹å®‰å…¨ä»¥åŠäº‹ä»¶å®Œæˆçš„é€šçŸ¥è¿˜è¦æ‰‹åŠ¨å»å°è£…ä¸€å¤§å †çš„ä¸œè¥¿ï¼ˆç”¨æ¡ä»¶å˜é‡ã€ä¿¡å·é‡ä¹‹ç±»çš„å»å°è£…ï¼‰ï¼Œæˆ‘ä»¬å¤§éƒ¨åˆ†åœºæ™¯å¹¶ä¸éœ€è¦è¿™ä¹ˆé«˜çš„æ§åˆ¶ç²’åº¦ï¼Œæ‰€ä»¥æ ‡å‡†åº“å¸®ä½ å°è£…äº†ä¸€ä¸ªpromiseå’Œå¯¹åº”çš„futureè¿›è¡Œçº¿ç¨‹é—´çš„é€šä¿¡ä¹Ÿæ˜¯ä¸€ä¸ªé€‰æ‹©ï¼Œå½“ç„¶å¦‚æœèƒ½å†è¿›åŒ–æˆGolangä¸­çš„channlæ¨¡æ ·ï¼Œé‚£å°±æ›´å¥½äº†ï¼ˆä¼¼ä¹C++20æœ‰åç¨‹åˆæœ‰ç®¡é“ğŸ˜ï¼‰ã€‚</p>
<p>è¯´äº†è¿™ä¹ˆå¤šï¼Œæ¥ä¸€ä¸ªç®€å•çš„ä¾‹å­å§ã€‚</p>
<blockquote>
<p>æˆ‘ä»¬å†åˆ‡æ¢åˆ°ä¸€ä¸ªåœºæ™¯ï¼šå®ç°ä¸€ä¸ªèŠå¤©ç¨‹åºçš„åå°æœåŠ¡å™¨ï¼Œæˆ‘ä»¬ä¸¾å…¶ä¸­è¾ƒä¸ºå¥‘åˆçš„åœ°æ–¹ï¼Œæ¯”å¦‚ä¸€ä¸ªèŠå¤©å®¤çš„æ¶ˆæ¯æ”¶å‘ï¼Œå½“èŠå¤©å®¤é‡Œçš„ä¸€ä¸ªäººå‘é€æ¶ˆæ¯åï¼Œéœ€è¦å°†è¯¥æ¶ˆæ¯å¯¹èŠå¤©å®¤é‡Œçš„å…¶ä»–äººè¿›è¡Œå¹¿æ’­ï¼Œè¿™ä¸ªå¹¿æ’­çš„è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¹¶å‘æ¥è¿›è¡Œï¼Œä½†æ˜¯æœ€å¥½å»ºè®®ä¸è¦æŠŠæ¯ä¸ªä»»åŠ¡éƒ½å¼€å¯ä¸€ä¸ªæ–°çº¿ç¨‹å»æ‰§è¡Œï¼Œè¿™æ ·æœåŠ¡å™¨è¿Ÿæ—©å´©æºƒï¼Œæœ€å¥½çš„åšæ³•æ˜¯ä½¿ç”¨çº¿ç¨‹æ± æˆ–è€…ç›´æ¥ä¸Šåç¨‹æ— æ‰€ç•æƒ§ã€‚è¿™é‡Œçš„æ‰§è¡ŒæˆåŠŸæˆ–è€…å¤±è´¥éœ€è¦ä¼ é€’åˆ°å¤–ç•Œï¼Œè¿™æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨promiseå½“ç„¶ä½ ä¹Ÿå¯ä»¥ç”¨package_taskå°†ä»»åŠ¡è¿›è¡Œå°è£…ï¼Œåªä¸è¿‡æ²¡æœ‰promiseçµæ´»ï¼ˆä½†å¤§éƒ¨åˆ†æ—¶å€™æ¯”promiseå¥½ç”¨ï¼Œæ¯”å¦‚è¿™é‡Œæˆ‘è¿˜æ˜¯ç”¨package_taskå¥½äº›ï¼‰</p>
</blockquote>
<p>æˆ‘ä»¬æŠŠè¯¥ç±»å‘½åä¸ºChatRoomç±»ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p>
<ul>
<li>broadcast(int userId,Message msg);ç”¨äºå¯¹æ¶ˆæ¯è¿›è¡Œå¹¿æ’­</li>
</ul>
<p>æˆ¿é—´å†…æœ‰éå¸¸å¤šçš„ç”¨æˆ·å¯¹åº”Userç±»ï¼Œè€Œuseræœ‰å¯¹åº”çš„æ¥æ”¶æ¶ˆæ¯çš„æ–¹æ³•ï¼š</p>
<ul>
<li>receive(Message msg); æ¥æ”¶å¯¹åº”çš„æ¶ˆæ¯</li>
</ul>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">broadcast</span><span class="p">(</span><span class="kt">int</span> <span class="n">userId</span><span class="p">,</span><span class="n">Message</span> <span class="n">msg</span><span class="p">){</span>
    <span class="n">vector</span><span class="o">&lt;</span><span class="n">future</span><span class="o">&lt;</span><span class="n">error</span><span class="o">&gt;&gt;</span> <span class="n">futures</span><span class="p">;</span>
    <span class="k">for</span><span class="p">(</span><span class="k">auto</span><span class="o">&amp;&amp;</span> <span class="nl">user</span><span class="p">:</span><span class="n">Users</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">user</span><span class="p">.</span><span class="n">id</span> <span class="o">!=</span> <span class="n">userId</span><span class="p">){</span>
           <span class="n">thread_pool</span><span class="p">.</span><span class="n">submit</span><span class="p">([</span><span class="o">&amp;</span><span class="p">]{</span>
           <span class="n">package_task</span><span class="o">&lt;</span><span class="kt">bool</span><span class="p">(</span><span class="n">Message</span><span class="p">)</span><span class="o">&gt;</span><span class="n">task</span><span class="p">{</span><span class="n">std</span><span class="o">::</span><span class="n">bind</span><span class="p">(</span><span class="n">User</span><span class="o">::</span><span class="n">recive</span><span class="p">,</span><span class="o">&amp;</span><span class="n">user</span><span class="p">)};</span>
           <span class="n">futures</span><span class="p">.</span><span class="n">push_back</span><span class="p">(</span><span class="n">task</span><span class="p">.</span><span class="n">get_future</span><span class="p">());</span>
           <span class="n">task</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
          <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="kt">bool</span> <span class="n">f</span><span class="p">;</span>
    <span class="k">do</span><span class="p">{</span> <span class="c1">//ä¸»çº¿ç¨‹ç­‰å¾…å®Œæˆå¹¶è¿›è¡Œå¯¹åº”çš„é”™è¯¯å¤„ç†ï¼Œå½“å…¨éƒ½å®Œæˆä»»åŠ¡æ‰§è¡Œå®Œæˆ
</span><span class="c1"></span>        <span class="n">f</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span><span class="k">auto</span><span class="o">&amp;&amp;</span> <span class="nl">f</span><span class="p">:</span><span class="n">futures</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">f</span><span class="p">.</span><span class="n">wait_for</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">seconds</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="n">std</span><span class="o">::</span><span class="n">future_status</span><span class="o">::</span><span class="n">ready</span><span class="p">){</span>
            <span class="p">...</span> <span class="c1">//å¯¹åº”çš„é”™è¯¯å¤„ç†
</span><span class="c1"></span>            <span class="k">continue</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
      <span class="p">}</span>
   <span class="p">}</span><span class="k">while</span><span class="p">(</span><span class="n">f</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div><p>å…¶å®è¿™é‡Œçš„çº¿ç¨‹æ± è¿”å›ä¸€ä¸ª future æ˜¯æœ€å¥½ï¼Œå¦åˆ™åŒæ­¥æ“ä½œå°†ä¸é‚£ä¹ˆä¼˜é›…ã€‚</p>
<h2 id="è‡ªé¡¶å‘ä¸‹">è‡ªé¡¶å‘ä¸‹</h2>
<p>çœ‹å®Œä¸Šé¢çš„å†…å®¹ï¼Œç›¸ä¿¡ä½ å¯¹è¿™äº›çº¿ç¨‹åŒæ­¥çš„apiåº”è¯¥æœ‰äº†ä¸€å®šçš„äº†è§£ï¼Œæˆ‘ä»¬ä¼šå‘ç°è¿™å‡ ä¸ªapiçš„åº”ç”¨åœºæ™¯éƒ½éå¸¸ç›¸ä¼¼ï¼Œå®é™…ä¸Šæ˜¯ä¸€å±‚å¥—ä¸€å±‚çš„å¾€ä¸Šè¿›è¡Œå°è£…èµ·æ¥å¾—åˆ°å¯¹åº”çš„åŠŸèƒ½çš„ã€‚</p>
<p>æœ‰äº†promiseï¼Œæˆ‘ä»¬å¯ä»¥å°è£…å‡ºpackage_taskï¼Œæœ‰äº†package_taskæˆ‘ä»¬å¯ä»¥å°è£…å‡ºasyncï¼Œè¿™éƒ½æ˜¯ä¸€ç¯å¥—ä¸€ç¯ï¼Œä½¿ç”¨çš„å¤æ‚åº¦ä¸æ–­é™ä½çš„åŒæ—¶ï¼Œçº¿ç¨‹åŒæ­¥çš„çµæ´»æ€§ä¹Ÿåœ¨ä¸æ–­é™ä½ã€‚å½“æˆ‘ä»¬éœ€è¦è‡ªå·±å°è£…ä¸€å¥—å·¥å…·çš„æ—¶å€™ï¼Œå¤§æ¦‚ç‡æ˜¯ç”¨çš„promiseå’Œpackage_taskæ¯”è¾ƒå¤šï¼Œè€Œæˆ‘ä»¬åªç®¡ç®€å•ä½¿ç”¨æ—¶ï¼Œåˆ™æœ€å¥½æ—¶ä½¿ç”¨å·²ç»å°è£…å¥½çš„ä¸Šå±‚apiã€‚<strong>æ¯”å¦‚æˆ‘ä»¬å¦‚æœè¦è‡ªå·±å®ç°ä¸€ä¸ªè¿”å›futureçš„çº¿ç¨‹æ± ï¼Œé‚£ä¹ˆå°è£…packaged_taskæ˜¯æœ€å¥½çš„é€‰æ‹©</strong>ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬è‡ªé¡¶å‘ä¸‹ï¼Œæ¥ç®€å•çœ‹çœ‹å¦‚ä½•å®ç°ï¼ˆä»¥ä¸‹ä»£ç éåŸåˆ›ï¼Œå¦‚æœ‰é›·åŒï¼Œé‚£å°±æ˜¯æˆ‘æŠ„çš„ğŸ˜¥ï¼‰ã€‚</p>
<h3 id="ç”¨packaged_taskå®ç°async">ç”¨packaged_taskå®ç°async</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="n">std</span><span class="o">::</span><span class="n">future</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">my_async</span><span class="p">(</span><span class="n">function</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">task</span><span class="p">,</span> <span class="kt">int</span> <span class="n">i</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">packaged_task</span><span class="o">&lt;</span><span class="kt">int</span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">package</span><span class="p">{</span><span class="n">task</span><span class="p">};</span>
    <span class="n">std</span><span class="o">::</span><span class="n">future</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">package</span><span class="p">.</span><span class="n">get_future</span><span class="p">();</span>

    <span class="n">std</span><span class="o">::</span><span class="kr">thread</span> <span class="n">t</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">move</span><span class="p">(</span><span class="n">package</span><span class="p">),</span> <span class="n">i</span><span class="p">);</span>
    <span class="n">t</span><span class="p">.</span><span class="n">detach</span><span class="p">();</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
    <span class="k">auto</span> <span class="n">task</span> <span class="o">=</span> <span class="p">[](</span><span class="kt">int</span> <span class="n">i</span><span class="p">)</span> <span class="p">{</span> <span class="n">std</span><span class="o">::</span><span class="n">this_thread</span><span class="o">::</span><span class="n">sleep_for</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">chrono</span><span class="o">::</span><span class="n">seconds</span><span class="p">(</span><span class="mi">5</span><span class="p">));</span> <span class="k">return</span> <span class="n">i</span><span class="o">+</span><span class="mi">100</span><span class="p">;</span> <span class="p">};</span>

    <span class="n">std</span><span class="o">::</span><span class="n">future</span><span class="o">&lt;</span><span class="kt">int</span><span class="o">&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">my_async</span><span class="p">(</span><span class="n">task</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">f</span><span class="p">.</span><span class="n">get</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><h3 id="ä½¿ç”¨promiseå®ç°packaged_task">ä½¿ç”¨promiseå®ç°packaged_task</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span><span class="o">&gt;</span> <span class="k">class</span> <span class="nc">my_task</span><span class="p">;</span>

<span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="n">R</span><span class="p">,</span> <span class="k">typename</span> <span class="p">...</span><span class="n">Args</span><span class="o">&gt;</span>
<span class="k">class</span> <span class="nc">my_task</span><span class="o">&lt;</span><span class="n">R</span><span class="p">(</span><span class="n">Args</span><span class="p">...)</span><span class="o">&gt;</span>
<span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">function</span><span class="o">&lt;</span><span class="n">R</span><span class="p">(</span><span class="n">Args</span><span class="p">...)</span><span class="o">&gt;</span> <span class="n">fn</span><span class="p">;</span>
    <span class="n">std</span><span class="o">::</span><span class="n">promise</span><span class="o">&lt;</span><span class="n">R</span><span class="o">&gt;</span> <span class="n">pr</span><span class="p">;</span>             <span class="c1">// the promise of the result
</span><span class="c1"></span><span class="k">public</span><span class="o">:</span>
    <span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="p">...</span><span class="n">Ts</span><span class="o">&gt;</span>
    <span class="k">explicit</span> <span class="n">my_task</span><span class="p">(</span><span class="n">Ts</span> <span class="o">&amp;&amp;</span><span class="p">...</span> <span class="n">ts</span><span class="p">)</span> <span class="o">:</span> <span class="n">fn</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">forward</span><span class="o">&lt;</span><span class="n">Ts</span><span class="o">&gt;</span><span class="p">(</span><span class="n">ts</span><span class="p">)...)</span> <span class="p">{</span> <span class="p">}</span>

    <span class="k">template</span> <span class="o">&lt;</span><span class="k">typename</span> <span class="p">...</span><span class="n">Ts</span><span class="o">&gt;</span>
    <span class="kt">void</span> <span class="k">operator</span><span class="p">()(</span><span class="n">Ts</span> <span class="o">&amp;&amp;</span><span class="p">...</span> <span class="n">ts</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">pr</span><span class="p">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">fn</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">forward</span><span class="o">&lt;</span><span class="n">Ts</span><span class="o">&gt;</span><span class="p">(</span><span class="n">ts</span><span class="p">)...));</span>  <span class="c1">// fulfill the promise
</span><span class="c1"></span>    <span class="p">}</span>

    <span class="n">std</span><span class="o">::</span><span class="n">future</span><span class="o">&lt;</span><span class="n">R</span><span class="o">&gt;</span> <span class="n">get_future</span><span class="p">()</span> <span class="p">{</span> <span class="k">return</span> <span class="n">pr</span><span class="p">.</span><span class="n">get_future</span><span class="p">();</span> <span class="p">}</span>

    <span class="c1">// disable copy, default move
</span><span class="c1"></span><span class="p">};</span>
</code></pre></div><h2 id="æ€»ç»“">æ€»ç»“</h2>
<ol>
<li>å¦‚æœéœ€è¦å°è£…è‡ªå·±çš„apiæ–¹ä¾¿ä½¿ç”¨ï¼Œé‚£ä¹ˆpackaged_taskå’Œpromiseå¯èƒ½æ˜¯ä½ æœ€å¸¸ç”¨çš„ã€‚</li>
<li>å¦‚æœæƒ³è¦å¼€ç®±å³ç”¨ï¼Œé‚£ä¹ˆç›´æ¥asyncä¹ŸæŒºå¥½ã€‚</li>
</ol>
</div><div class="post-footer" id="post-footer">
    <div class="post-info"><div class="post-info-tag"><span><a href="/tags/asyncpackaged_taskpromisefuture%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E4%BD%BF%E7%94%A8/">asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨</a>
                </span></div><div class="post-info-line"><div class="post-info-mod">
                <span>æ›´æ–°äº 2022-08-17</span>
            </div><div class="post-info-mod"></div>
        </div><div class="post-info-share">
            <span><a href="javascript:void(0);" title="åˆ†äº«åˆ° Twitter" data-sharer="twitter" data-url="https://acking-you.github.io/posts/asyncpackage_task%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E4%BD%BF%E7%94%A8/" data-title="asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨" data-hashtags="asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Facebook" data-sharer="facebook" data-url="https://acking-you.github.io/posts/asyncpackage_task%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E4%BD%BF%E7%94%A8/" data-hashtag="asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° WhatsApp" data-sharer="whatsapp" data-url="https://acking-you.github.io/posts/asyncpackage_task%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E4%BD%BF%E7%94%A8/" data-title="asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Line" data-sharer="line" data-url="https://acking-you.github.io/posts/asyncpackage_task%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E4%BD%BF%E7%94%A8/" data-title="asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨"><i class="fab fa-line fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° å¾®åš" data-sharer="weibo" data-url="https://acking-you.github.io/posts/asyncpackage_task%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E4%BD%BF%E7%94%A8/" data-title="asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨" data-image="https://img-blog.csdnimg.cn/img_convert/c592952aec4e1c875073f2a3d970cde5.png#pic_center"><i class="fab fa-weibo fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Myspace" data-sharer="myspace" data-url="https://acking-you.github.io/posts/asyncpackage_task%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E4%BD%BF%E7%94%A8/" data-title="asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨" data-description="asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨"><i data-svg-src="/lib/simple-icons/icons/myspace.min.svg"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Blogger" data-sharer="blogger" data-url="https://acking-you.github.io/posts/asyncpackage_task%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E4%BD%BF%E7%94%A8/" data-title="asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨" data-description="asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨"><i class="fab fa-blogger fa-fw"></i></a><a href="javascript:void(0);" title="åˆ†äº«åˆ° Evernote" data-sharer="evernote" data-url="https://acking-you.github.io/posts/asyncpackage_task%E7%9A%84%E5%8C%BA%E5%88%AB%E4%B8%8E%E4%BD%BF%E7%94%A8/" data-title="asyncã€packaged_taskã€promiseã€futureçš„åŒºåˆ«ä¸ä½¿ç”¨"><i class="fab fa-evernote fa-fw"></i></a></span>
        </div></div><div class="post-nav"><a href="/posts/c&#43;&#43;%E9%9D%A2%E8%AF%95%E4%B8%80%E6%9D%A1%E8%B7%AF/" class="prev" rel="prev" title="C&#43;&#43;é¢è¯•é¢è¯•ä¸€æ¡é¾™"><i class="fas fa-angle-left fa-fw"></i>Previous Post</a>
            <a href="/posts/%E7%BB%86%E7%B2%92%E5%BA%A6%E9%94%81%E7%BA%BF%E7%A8%8B%E5%AE%89%E5%85%A8%E9%98%9F%E5%88%97%E5%AE%9E%E7%8E%B0/" class="next" rel="next" title="ç»†ç²’åº¦é”çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—å®ç°">Next Post<i class="fas fa-angle-right fa-fw"></i></a></div></div>
</div></article></div>
            </main>
            <footer class="footer"><div class="footer-container"><div class="footer-line">ç”± <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.86.0">Hugo</a> å¼ºåŠ›é©±åŠ¨ | ä¸»é¢˜ - <a href="https://github.com/khusika/FeelIt" target="_blank" rel="noopener noreffer" title="FeelIt 1.0.1"><i class="fas fa-hand-holding-heart fa-fw"></i> FeelIt</a>
        </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/"></a></span></div>
</div>
</footer>
        </div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="å›åˆ°é¡¶éƒ¨">
                <i class="fas fa-chevron-up fa-fw"></i>
            </a></div><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><script src="/lib/autocomplete/autocomplete.min.js"></script><script src="/lib/lunr/lunr.min.js"></script><script src="/lib/lunr/lunr.stemmer.support.min.js"></script><script src="/lib/lunr/lunr.zh.min.js"></script><script src="/lib/lazysizes/lazysizes.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script src="/lib/sharer/sharer.min.js"></script><script src="/lib/katex/katex.min.js"></script><script src="/lib/katex/auto-render.min.js"></script><script src="/lib/katex/copy-tex.min.js"></script><script src="/lib/katex/mhchem.min.js"></script><script>window.config={"code":{"copyTitle":"å¤åˆ¶åˆ°å‰ªè´´æ¿","maxShownLines":200},"comment":{},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","lunrLanguageCode":"zh","lunrSegmentitURL":"/lib/lunr/lunr.segmentit.js","maxResultLength":100,"noResultsFound":"æ²¡æœ‰æ‰¾åˆ°ç»“æœ","snippetLength":50,"type":"lunr"}};</script><script src="/js/theme.min.js"></script></body></html>
